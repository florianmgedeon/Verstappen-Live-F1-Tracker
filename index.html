<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verstappen Live Tracker</title>
</head>
<body>
    <h1>Verstappen Live Tracker</h1>
    <p>Current speed: <span id="speedDisplay">Loading...</span> km/h</p>
    <p>Current interval: <span id="intervalDisplay">Loading...</span> s</p>
    <p>Last lap: <span id="lapDisplay">Loading...</span> s</p>
    <p>Lap Delta: <span id="lapDeltaDisplay">Loading...</span> s</p>
    <p>Sector 1: <span id="sector1Display">Loading...</span> s</p>
    <p>Sector 2: <span id="sector2Display">Loading...</span> s</p>
    <p>Sector 3: <span id="sector3Display">Loading...</span> s</p>
    <p>Sector 1 Delta: <span id="sector1DeltaDisplay">Loading...</span> s</p>
    <p>Sector 2 Delta: <span id="sector2DeltaDisplay">Loading...</span> s</p>
    <p>Sector 3 Delta: <span id="sector3DeltaDisplay">Loading...</span> s</p>
    <p>FIA Flag: <span id="flagDisplay">Loading...</span></p>
    <p>FIA Message: <span id="messageDisplay">Loading...</span></p>
    <p>Radio:</p>
    <audio id="radioPlayer" controls></audio>
    <script src="script.js"></script>
    <script>
        // Update the speed display
        function updateSpeed(speed) {
            document.getElementById('speedDisplay').textContent = speed;
        }
        // Update the interval display
        function updateInterval(interval) {
            document.getElementById('intervalDisplay').textContent = interval;
        }
        // Update the interval display
        let previousLap = null;
        function updateLap(lap) {
            document.getElementById('lapDisplay').textContent = lap;
            if (previousLap != null) {
                const lapDelta = lap - previousLap;
                updateLapDelta(lapDelta);
            }
            previousLap = lap;
        }
        // Update the lapdelta display
        function updateLapDelta(lapDelta) {
            document.getElementById('lapDeltaDisplay').textContent = parseFloat(lapDelta).toFixed(3);
        }
        // Update the sector displays
        let previousSector1 = null;
        function updateSector1(sector1) {
            document.getElementById('sector1Display').textContent = sector1;
            if (previousSector1 != null) {
                const sector1Delta = sector1 - previousSector1;
                updateSector1Delta(sector1Delta);
            }
            previousSector1 = sector1;
        }
        let previousSector2 = null;
        function updateSector2(sector2) {
            document.getElementById('sector2Display').textContent = sector2;
            if (previousSector2 != null) {
                const sector2Delta = sector2 - previousSector2;
                updateSector2Delta(sector2Delta);
            }
            previousSector2 = sector2;
        }
        let previousSector3 = null;
        function updateSector3(sector3) {
            document.getElementById('sector3Display').textContent = sector3;
            if (previousSector3 != null) {
                const sector3Delta = sector3 - previousSector3;
                updateSector3Delta(sector3Delta);
            }
            previousSector3 = sector3;
        }

        // Update the sector delta displays
        function updateSector1Delta(sector1Delta) {
            document.getElementById('sector1DeltaDisplay').textContent = parseFloat(sector1Delta).toFixed(3);
        }
        function updateSector2Delta(sector2Delta) {
            document.getElementById('sector2DeltaDisplay').textContent = parseFloat(sector2Delta).toFixed(3);
        }
        function updateSector3Delta(sector3Delta) {
            document.getElementById('sector3DeltaDisplay').textContent = parseFloat(sector3Delta).toFixed(3);
        }

        // Update the race control display
        function updateFlag(flag) {
            document.getElementById('flagDisplay').textContent = flag;
        }
        function updateMessage(message) {
            document.getElementById('messageDisplay').textContent = message;
        }
        //Update the radio display
        function updateRadio(recording_url) {
            const player = document.getElementById('radioPlayer');
            player.src = recording_url;
            player.play();
        }

        //call fetchData initially
        fetchData();

        //call fetchInterval initially
        fetchInterval();

        //call fetchLap initially
        fetchLap();

        //call fetchRaceControl initially
        fetchRaceControl();

        //call fetchRadio initially
        fetchRadio();

        setInterval(fetchData, 1500);
        setInterval(fetchInterval, 1500);
        setInterval(fetchLap, 1500);
        setInterval(fetchRaceControl, 1500);
        setInterval(fetchRadio, 1500);
    </script>
</body>
</html>
